const __vite__fileDeps=["assets/Skeleton-BopQooJg.js","assets/index-gS0fNKXR.js","assets/index-CrrrOxeG.css","assets/Skeleton-Dtgk0KiV.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{r as t,U as v,j as e,_ as E,P as I}from"./index-gS0fNKXR.js";const m=t.lazy(()=>E(()=>import("./Skeleton-BopQooJg.js"),__vite__mapDeps([0,1,2,3])));function S({postId:i}){const[a,d]=t.useState(null),[x,p]=t.useState(!1),[r,g]=t.useState(""),[l,h]=t.useState(""),[c,f]=t.useState(""),[j,P]=t.useState(!0),{isAdmin:N}=v();t.useEffect(()=>{(async()=>{try{const n=await(await fetch(`https://api-postgres.onrender.com/blogs/${i}`)).json();console.log("Post Data:",n),d(n),P(!1)}catch(o){console.error("Error fetching post:",o)}})()},[i]),t.useEffect(()=>{a&&a.length>0&&(g(a[0].title),h(a[0].content))},[a]);const w=async()=>{try{(await fetch(`https://api-postgres.onrender.com/blogs/${i}`,{method:"DELETE"})).status===200?(console.log("Post deleted successfully"),window.location.href="/home"):console.log("Error deleting post")}catch(s){console.error("Error deleting post:",s)}},y=async s=>{s.preventDefault();try{console.log("Data to send:",{title:r,content:l,image64:c});const n=await(await fetch(`https://api-postgres.onrender.com/blogs/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:r,content:l,image64:c})})).json();console.log("Updated Post Data:",n),d(n),p(!1),window.location.reload()}catch(o){console.error("Error updating post:",o)}};if(j)return e.jsx(t.Suspense,{fallback:e.jsx(m,{}),children:e.jsx(m,{})});const u=()=>{alert("Only admin can do this action")};return e.jsx("div",{className:"singlePost",children:e.jsx("div",{className:"singlePostWrapper",children:x?e.jsx("div",{className:"write",children:e.jsxs("form",{className:"writeForm",onSubmit:s=>y(s),children:[e.jsxs("div",{className:"writeFormGroup",children:[e.jsx("label",{htmlFor:"fileInput",children:e.jsx("i",{className:"writeIcon fa-solid fa-plus"})}),e.jsx("input",{type:"file",id:"fileInput",style:{display:"none"}}),e.jsx("input",{type:"text",placeholder:"New Title",autoFocus:!0,value:r,onChange:s=>g(s.target.value),className:"writeInput"})]}),e.jsx("div",{className:"writeFormGroup",children:e.jsx("textarea",{placeholder:"New Content",style:{width:"100%",height:"60vh"},value:l,type:"text",onChange:s=>h(s.target.value),className:"writeInput writeText"})}),e.jsx("div",{className:"writeFormGroup",children:e.jsx("textarea",{placeholder:"URL de la imagen",value:c,type:"text",style:{width:"100%",height:"5vh"},onChange:s=>f(s.target.value),className:"writeText"})}),e.jsx("button",{type:"submit",className:"writeSubmit",children:"Save"})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"singlePostTitle",children:[e.jsx("img",{src:a[0].image64,alt:"",className:"singlePostImg"}),a[0].title,e.jsx("div",{className:"singlePostEdit",children:N?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"singlePostIcon fa-regular fa-pen-to-square",onClick:()=>p(!0)}),e.jsx("i",{className:"singlePostIcon fa-regular fa-trash-can",onClick:()=>w()})]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"singlePostIcon fa-regular fa-pen-to-square",onClick:()=>u()}),e.jsx("i",{className:"singlePostIcon fa-regular fa-trash-can",onClick:()=>u()})]})})]}),e.jsxs("div",{className:"singlePostInfo",children:[e.jsxs("span",{className:"singlePostAuthor",children:["Autor: ",e.jsx("b",{children:"IRVS"})," "]}),e.jsxs("span",{className:"singlePostDate",children:["Date: ",a[0]._date," "]})]}),e.jsx("p",{className:"singlePostDesc",children:a[0].content})]})})})}S.propTypes={postId:I.string.isRequired};export{S as default};
